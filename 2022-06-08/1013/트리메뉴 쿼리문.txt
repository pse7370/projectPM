WITH TREE (label, value, parent, product_id) AS
(
	SELECT DISTINCT product_type AS label, product_type AS value, '' AS parent, 0 AS product_id
	FROM product
	
	UNION ALL

	SELECT p.product_name AS label, p.product_name AS value, p.product_type AS parent, p.product_id
	FROM product AS p
)
SELECT label, value, parent, product_id
FROM TREE
ORDER BY product_id DESC, parent ASC;

===========================================

WITH TREE (label, value, parent, product_id) AS
(
	SELECT DISTINCT product_type AS label, product_type AS value, '' AS parent, 0 AS product_id
	FROM product
	
	UNION ALL

	SELECT p.product_name AS label, p.product_name AS value, p.product_type AS parent, p.product_id
	FROM product AS p

	UNION ALL

	SELECT '커스터마이징' AS label, '커스터마이징' + CAST(product_id AS varchar) AS value, product_name AS parent, product_id
	FROM product

	UNION ALL

	SELECT '산출물' AS label, '산출물' + CAST(product_id AS varchar) AS value, product_name AS parent, product_id
	FROM product
)
SELECT label, value, parent, product_id
FROM TREE
ORDER BY product_id DESC, parent ASC;

--SELECT COUNT(product_id)*3 + COUNT(DISTINCT product_type) FROM product; 


--select COUNT(distinct product_type) from product;

